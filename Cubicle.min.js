(function(n){var i={},t=function(n){return typeof n=="function"},r=function(t,r,u){for(var h,o,f=t.split("."),e=u===!0?n:i,s=0;s<f.length-1;s++)h=f[s],o=e[h],o||(o=e[h]={}),e=o;return e[f[f.length-1]]=r,r},u=function(n){for(var e,u,f=n.split("."),t=i,r=0;r<f.length;r++)if(e=f[r],u=t[e],t=u,!u)break;return t};n.Cubicle=function(){for(var o=arguments,s=o.length,f=0,e,h,i,f=0;f<s;f++)e=o[f],t(e)&&(h=function(){},i=e.apply(n,[u,r]),i&&(i.init&&t(i.init)?i.init():i.constructor.name=="Promise"&&i.then(function(n){n&&n.init&&t(n.init)&&n.init()})))};Cubicle(function(n,t){return t("messaging",{init:function(){this._list=[]},listen:function(n,t,i){this._list.push({channel:n,context:t,callback:i})},unlisten:function(n,t){for(var r,i=0,u=this._list.length;i<u;i++)if(r=this._list[i],r.channel===n&&r.context===t)return this._list.splice(i,1),!0;return!1},publish:function(n,t){for(var r,i=0,u=this._list.length;i<u;i++)r=this._list[i],r.channel===n&&r.callback.apply(r.context,[t])}})})})(this)
